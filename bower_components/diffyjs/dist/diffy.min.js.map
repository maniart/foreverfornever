{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///diffy.min.js","webpack:///webpack/bootstrap 5d38139da365b9cbe5c8","webpack:///./src/index.js","webpack:///./src/Diffy.js","webpack:///./src/raf.js","webpack:///./src/capture.js","webpack:///./src/worker.js","webpack:///./~/worker-loader/createInlineWorker.js","webpack:///./src/utils.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","create","undefined","_Diffy","_Diffy2","_raf","_raf2","_capture","_capture2","_worker","_worker2","_utils","instanceExists","_ref","resolution","sensitivity","threshold","debug","onFrame","sourceDimensions","containerClassName","window","Error","diffy","tickFn","captureFn","DiffWorker","roundFn","win","doc","document","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","Diffy","_ref$tickFn","_ref$captureFn","_ref$DiffWorker","_ref$roundFn","_ref$win","_ref$doc","_ref$debug","_ref$sourceDimensions","w","h","_ref$onFrame","_ref$sensitivity","_ref$threshold","_ref$containerClassNa","_ref$resolution","x","y","_win","baseCaptureConfig","audio","video","width","height","captureConfig","assign","bind","currentImageData","previousImageData","resolutionX","resolutionY","debugViewCollapsed","sourceWidth","sourceHeight","worker","initialized","VERSION","addEventListener","init","blob","videoEl","src","canvas","getContext","drawImage","ctx","translate","scale","frame1","frame2","data1","data","data2","buffer","ArrayBuffer","postMessage","blendImageData","set","Uint8ClampedArray","blendCanvasCtx","putImageData","getImageData","compare","j","k","matrix","cellWidth","cellHeight","cellImageData","cellImageDataLength","cellPixelCount","average","row","push","toCanvas","rawCanvasEl","blend","createMatrix","loop","_this","e","_ref2","drawBlendImageFromBuffer","initDom","blendCanvasEl","then","forEach","mirror","toVideo","_this2","containerEl","createElement","className","setAttribute","headerEl","titleEl","innerText","toggleEl","ev","preventDefault","el","classList","remove","add","appendChild","body","node","styles","innerHTML","createElements","injectCssStyles","options","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","getUserMedia","constraints","successCallback","errorCallback","navigator","webkitGetUserMedia","mozGetUserMedia","Promise","reject","mediaDevices","capture","stream","URL","createObjectURL","catch","name","message","console","error","webkitURL","content","url","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","Blob","Worker","encodeURIComponent","createOnceLog","counter","_console","log","apply","arguments","$","selector","querySelector","round","number","abs","polarize"],"mappings":"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","file":"diffy.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Diffy\"] = factory();\n\telse\n\t\troot[\"Diffy\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Diffy\"] = factory();\n\telse\n\t\troot[\"Diffy\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.create = undefined;\n\t\n\tvar _Diffy = __webpack_require__(2);\n\t\n\tvar _Diffy2 = _interopRequireDefault(_Diffy);\n\t\n\tvar _raf = __webpack_require__(3);\n\t\n\tvar _raf2 = _interopRequireDefault(_raf);\n\t\n\tvar _capture = __webpack_require__(4);\n\t\n\tvar _capture2 = _interopRequireDefault(_capture);\n\t\n\tvar _worker = __webpack_require__(5);\n\t\n\tvar _worker2 = _interopRequireDefault(_worker);\n\t\n\tvar _utils = __webpack_require__(7);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar instanceExists = false; /* eslint-disable no-console */\n\t\n\tvar create = exports.create = function create(_ref) {\n\t  var resolution = _ref.resolution,\n\t      sensitivity = _ref.sensitivity,\n\t      threshold = _ref.threshold,\n\t      debug = _ref.debug,\n\t      onFrame = _ref.onFrame,\n\t      sourceDimensions = _ref.sourceDimensions,\n\t      containerClassName = _ref.containerClassName;\n\t\n\t\n\t  if (!window) {\n\t    throw new Error('\\n      Diffy.js is meant to be used in the browser. :^)\\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\\n    ');\n\t  }\n\t\n\t  if (!('Worker' in window)) {\n\t    throw new Error('\\n      Diffy.js requires Web Workers.\\n      It looks like this environment does not support this feature. :(\\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\\n    ');\n\t  }\n\t\n\t  if (instanceExists) {\n\t    throw new Error('\\n      Yikes! It seems like a Diffy.js instance already exists on this page. :|\\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\\n    ');\n\t  }\n\t\n\t  var diffy = _Diffy2.default.create({\n\t    tickFn: _raf2.default,\n\t    captureFn: _capture2.default,\n\t    DiffWorker: _worker2.default,\n\t    roundFn: _utils.round,\n\t    win: window,\n\t    doc: document,\n\t    resolution: resolution,\n\t    sensitivity: sensitivity,\n\t    threshold: threshold,\n\t    debug: debug,\n\t    onFrame: onFrame,\n\t    sourceDimensions: sourceDimensions,\n\t    containerClassName: containerClassName\n\t  });\n\t\n\t  instanceExists = true;\n\t  return diffy;\n\t};\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Diffy = function () {\n\t  function Diffy(_ref) {\n\t    var _ref$tickFn = _ref.tickFn,\n\t        tickFn = _ref$tickFn === undefined ? function () {} : _ref$tickFn,\n\t        _ref$captureFn = _ref.captureFn,\n\t        captureFn = _ref$captureFn === undefined ? function () {} : _ref$captureFn,\n\t        _ref$DiffWorker = _ref.DiffWorker,\n\t        DiffWorker = _ref$DiffWorker === undefined ? function () {} : _ref$DiffWorker,\n\t        _ref$roundFn = _ref.roundFn,\n\t        roundFn = _ref$roundFn === undefined ? function () {} : _ref$roundFn,\n\t        _ref$win = _ref.win,\n\t        win = _ref$win === undefined ? {} : _ref$win,\n\t        _ref$doc = _ref.doc,\n\t        doc = _ref$doc === undefined ? {} : _ref$doc,\n\t        _ref$debug = _ref.debug,\n\t        debug = _ref$debug === undefined ? false : _ref$debug,\n\t        _ref$sourceDimensions = _ref.sourceDimensions,\n\t        sourceDimensions = _ref$sourceDimensions === undefined ? { w: 130, h: 100 } : _ref$sourceDimensions,\n\t        _ref$onFrame = _ref.onFrame,\n\t        onFrame = _ref$onFrame === undefined ? function () {} : _ref$onFrame,\n\t        _ref$sensitivity = _ref.sensitivity,\n\t        sensitivity = _ref$sensitivity === undefined ? 0.2 : _ref$sensitivity,\n\t        _ref$threshold = _ref.threshold,\n\t        threshold = _ref$threshold === undefined ? 21 : _ref$threshold,\n\t        _ref$containerClassNa = _ref.containerClassName,\n\t        containerClassName = _ref$containerClassNa === undefined ? 'diffy--debug-view' : _ref$containerClassNa,\n\t        _ref$resolution = _ref.resolution,\n\t        resolution = _ref$resolution === undefined ? { x: 10, y: 5 } : _ref$resolution;\n\t\n\t    _classCallCheck(this, Diffy);\n\t\n\t    var _win = win;\n\t    this.doc = doc;\n\t\n\t    var baseCaptureConfig = {\n\t      audio: false,\n\t      video: {\n\t        width: 130,\n\t        height: 100\n\t      }\n\t    };\n\t\n\t    this.captureConfig = Object.assign({}, baseCaptureConfig, {\n\t      video: { width: sourceDimensions.w, height: sourceDimensions.h }\n\t    });\n\t\n\t    this.tickFn = tickFn.bind(_win);\n\t    this.captureFn = captureFn;\n\t    this.roundFn = roundFn;\n\t\n\t    this.onFrame = onFrame;\n\t\n\t    this.currentImageData = null;\n\t    this.previousImageData = null;\n\t\n\t    this.resolutionX = resolution.x;\n\t    this.resolutionY = resolution.y;\n\t\n\t    this.sensitivity = sensitivity;\n\t    this.threshold = threshold;\n\t\n\t    this.debug = debug;\n\t    this.containerClassName = containerClassName;\n\t    this.debugViewCollapsed = false;\n\t\n\t    this.sourceWidth = sourceDimensions.w;\n\t    this.sourceHeight = sourceDimensions.h;\n\t\n\t    this.worker = new DiffWorker();\n\t\n\t    this.initialized = false;\n\t\n\t    this.VERSION = '1.2.2';\n\t\n\t    _win.addEventListener('load', this.init.bind(this));\n\t  }\n\t\n\t  _createClass(Diffy, [{\n\t    key: 'toVideo',\n\t    value: function toVideo(blob, videoEl) {\n\t      // piping blob to video element\n\t      videoEl.src = blob;\n\t    }\n\t  }, {\n\t    key: 'toCanvas',\n\t    value: function toCanvas(video, canvas) {\n\t      // piping video to canvas\n\t      canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\n\t    }\n\t  }, {\n\t    key: 'mirror',\n\t    value: function mirror(canvas) {\n\t      var ctx = canvas.getContext('2d');\n\t      ctx.translate(canvas.width, 0);\n\t      ctx.scale(-1, 1);\n\t      return canvas;\n\t    }\n\t  }, {\n\t    key: 'compare',\n\t    value: function compare(frame1, frame2) {\n\t      var data1 = frame1.data;\n\t      var data2 = frame2.data;\n\t      var length = data1.length;\n\t      var buffer = new ArrayBuffer(length);\n\t\n\t      this.worker.postMessage({\n\t        buffer: buffer,\n\t        data1: data1,\n\t        data2: data2,\n\t        sensitivity: this.sensitivity,\n\t        threshold: this.threshold,\n\t        width: this.sourceWidth,\n\t        height: this.sourceHeight\n\t      });\n\t    }\n\t  }, {\n\t    key: 'drawBlendImageFromBuffer',\n\t    value: function drawBlendImageFromBuffer(buffer) {\n\t      this.blendImageData.data.set(new Uint8ClampedArray(buffer));\n\t\n\t      this.blendCanvasCtx.putImageData(this.blendImageData, 0, 0);\n\t      this.previousImageData = this.currentImageData;\n\t    }\n\t\n\t    /*\n\t      blend two consecutive frames\n\t      returns imageData\n\t    */\n\t\n\t  }, {\n\t    key: 'blend',\n\t    value: function blend(canvas) {\n\t      var ctx = canvas.getContext('2d');\n\t      var width = canvas.width;\n\t      var height = canvas.height;\n\t      this.currentImageData = ctx.getImageData(0, 0, width, height);\n\t      this.previousImageData = this.previousImageData || ctx.getImageData(0, 0, width, height);\n\t      this.compare(this.currentImageData, this.previousImageData);\n\t    }\n\t  }, {\n\t    key: 'createMatrix',\n\t    value: function createMatrix() {\n\t      var i = void 0;\n\t      var j = void 0;\n\t      var k = 0;\n\t\n\t      var matrix = [];\n\t      var sourceWidth = this.sourceWidth;\n\t      var sourceHeight = this.sourceHeight;\n\t      var cellWidth = this.sourceWidth / this.resolutionX;\n\t      var cellHeight = this.sourceHeight / this.resolutionY;\n\t\n\t      var cellImageData = null;\n\t      var cellImageDataLength = void 0;\n\t      var cellPixelCount = void 0;\n\t      var average = 0;\n\t\n\t      for (i = 0; i < sourceWidth; i += cellWidth) {\n\t        var row = [];\n\t\n\t        for (j = 0; j < sourceHeight; j += cellHeight) {\n\t          cellImageData = this.blendCanvasCtx.getImageData(i, j, cellWidth, cellHeight).data;\n\t\n\t          /* TODO refactor with bitshifting */\n\t          cellImageDataLength = cellImageData.length;\n\t          cellPixelCount = cellImageDataLength / 4;\n\t          while (k < cellPixelCount) {\n\t            average += (cellImageData[k * 4] + cellImageData[k * 4 + 1] + cellImageData[k * 4 + 2]) / 3;\n\t            ++k;\n\t          }\n\t          average = this.roundFn(average / cellPixelCount);\n\t          /* push the value in the row */\n\t          row.push(average);\n\t          average = 0;\n\t          k = 0;\n\t        }\n\t        matrix.push(row); // store the row in matrix\n\t      }\n\t\n\t      return matrix;\n\t    }\n\t  }, {\n\t    key: 'loop',\n\t    value: function loop() {\n\t      this.toCanvas(this.videoEl, this.rawCanvasEl);\n\t      this.blend(this.rawCanvasEl);\n\t      this.onFrame(this.createMatrix());\n\t      this.tickFn(this.loop.bind(this));\n\t    }\n\t  }, {\n\t    key: 'init',\n\t    value: function init() {\n\t      var _this = this;\n\t\n\t      this.worker.addEventListener('error', function (e) {\n\t        throw e;\n\t      });\n\t      this.worker.addEventListener('message', function (_ref2) {\n\t        var data = _ref2.data;\n\t\n\t        _this.drawBlendImageFromBuffer(data);\n\t      });\n\t      this.initDom(this.containerClassName);\n\t      this.blendCanvasCtx = this.blendCanvasEl.getContext('2d');\n\t      this.blendImageData = this.blendCanvasCtx.getImageData(0, 0, this.sourceWidth, this.sourceHeight);\n\t\n\t      this.captureFn(this.captureConfig).then(function (blob) {\n\t        [_this.rawCanvasEl, _this.blendCanvasEl].forEach(_this.mirror);\n\t        _this.toVideo(blob, _this.videoEl);\n\t        _this.loop();\n\t      });\n\t      this.initialized = true;\n\t    }\n\t  }, {\n\t    key: 'createElements',\n\t    value: function createElements(containerClassName) {\n\t      var _this2 = this;\n\t\n\t      this.containerEl = this.doc.createElement('div');\n\t      this.containerEl.className = containerClassName;\n\t\n\t      this.videoEl = this.doc.createElement('video');\n\t      this.videoEl.className = 'video view';\n\t      this.videoEl.setAttribute('autoplay', '');\n\t      this.videoEl.width = this.sourceWidth;\n\t      this.videoEl.height = this.sourceHeight;\n\t\n\t      this.rawCanvasEl = this.doc.createElement('canvas');\n\t      this.rawCanvasEl.className = 'canvas--raw view';\n\t      this.rawCanvasEl.width = this.sourceWidth;\n\t      this.rawCanvasEl.height = this.sourceHeight;\n\t\n\t      this.blendCanvasEl = this.doc.createElement('canvas');\n\t      this.blendCanvasEl.className = 'canvas--blend view';\n\t      this.blendCanvasEl.width = this.sourceWidth;\n\t      this.blendCanvasEl.height = this.sourceHeight;\n\t\n\t      this.headerEl = this.doc.createElement('header');\n\t      this.headerEl.className = 'header';\n\t\n\t      this.titleEl = this.doc.createElement('h1');\n\t      this.titleEl.className = 'title';\n\t      this.titleEl.innerText = 'Diffy debug view';\n\t\n\t      this.toggleEl = this.doc.createElement('span');\n\t      this.toggleEl.className = 'toggle';\n\t      this.toggleEl.innerText = '-';\n\t\n\t      this.headerEl.addEventListener('click', function (ev) {\n\t        ev.preventDefault();\n\t        [_this2.videoEl, _this2.rawCanvasEl, _this2.blendCanvasEl].forEach(function (el) {\n\t          if (_this2.debugViewCollapsed) {\n\t            el.classList.remove('hidden');\n\t            _this2.toggleEl.innerText = '-';\n\t          } else {\n\t            el.classList.add('hidden');\n\t            _this2.toggleEl.innerText = '+';\n\t          }\n\t        });\n\t        _this2.debugViewCollapsed = !_this2.debugViewCollapsed;\n\t      });\n\t\n\t      this.headerEl.appendChild(this.toggleEl);\n\t      this.headerEl.appendChild(this.titleEl);\n\t\n\t      this.containerEl.appendChild(this.headerEl);\n\t      this.containerEl.appendChild(this.videoEl);\n\t      this.containerEl.appendChild(this.rawCanvasEl);\n\t      this.containerEl.appendChild(this.blendCanvasEl);\n\t\n\t      this.doc.body.appendChild(this.containerEl);\n\t\n\t      if (!this.debug) {\n\t        this.containerEl.classList.add('hidden');\n\t      }\n\t    }\n\t  }, {\n\t    key: 'injectCssStyles',\n\t    value: function injectCssStyles() {\n\t      var node = this.doc.createElement('style');\n\t      var containerClassName = this.containerClassName;\n\t      var styles = '\\n      .' + containerClassName + ' {\\n        position: fixed;\\n        top: 0;\\n        left: 0;\\n        font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\\n        background-color: #000;\\n        border: 4px solid #000;\\n        color: #fff;\\n      }\\n      .' + containerClassName + ' .header {\\n        width: 100%;\\n        background-color: #000;\\n        font-size: 16px;\\n        cursor: pointer;\\n      }\\n      .' + containerClassName + ' .title {\\n        display: inline;\\n        margin-left: 10px;\\n        font-weight: 300;\\n        letter-spacing: 2px;\\n        font-size: 16px;\\n      }\\n      .' + containerClassName + ' .toggle { padding: 5px; }\\n      .' + containerClassName + ' .view { padding: 5px; }\\n      .' + containerClassName + ' .view.hidden, .' + containerClassName + '.hidden { display: none; }\\n    ';\n\t      node.innerHTML = styles;\n\t      this.doc.body.appendChild(node);\n\t    }\n\t  }, {\n\t    key: 'initDom',\n\t    value: function initDom(containerClassName) {\n\t      this.createElements(containerClassName);\n\t      this.injectCssStyles();\n\t    }\n\t  }], [{\n\t    key: 'create',\n\t    value: function create(options) {\n\t      return new this(options);\n\t    }\n\t  }]);\n\t\n\t  return Diffy;\n\t}();\n\t\n\texports.default = Diffy;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/*\n\t  shim requestAnimationFrame api\n\t  source: http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n\t*/\n\tvar requestAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {\n\t  window.setTimeout(callback, 1000 / 60);\n\t};\n\t\n\texports.default = requestAnimFrame;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/* eslint-disable no-unused-vars */\n\t/* eslint-disable no-console */\n\t/*\n\t  shim getUserMedia with a Promise api\n\t  source: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n\t*/\n\tvar getUserMedia = function getUserMedia(constraints, successCallback, errorCallback) {\n\t\n\t  // First get a hold of getUserMedia, if present\n\t  var getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\t\n\t  // Some browsers just don't implement it - return a rejected promise with an error\n\t  // to keep a consistent interface\n\t  if (!getUserMedia) {\n\t    return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n\t  }\n\t\n\t  // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n\t  return new Promise(function (successCallback, errorCallback) {\n\t    getUserMedia.call(navigator, constraints, successCallback, errorCallback);\n\t  });\n\t};\n\t\n\t// Older browsers might not implement mediaDevices at all, so we set an empty object first\n\tif (navigator.mediaDevices === undefined) {\n\t  navigator.mediaDevices = {};\n\t}\n\t\n\t// Some browsers partially implement mediaDevices. We can't just assign an object\n\t// with getUserMedia as it would overwrite existing properties.\n\t// Here, we will just add the getUserMedia property if it's missing.\n\tif (navigator.mediaDevices.getUserMedia === undefined) {\n\t  navigator.mediaDevices.getUserMedia = getUserMedia;\n\t}\n\t\n\t/*\n\t  capture from camera\n\t  returns objectUrl\n\t */\n\tvar capture = function capture(constraints) {\n\t  return navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n\t    return window.URL.createObjectURL(stream);\n\t  }).catch(function (_ref) {\n\t    var name = _ref.name,\n\t        message = _ref.message;\n\t    return console.error(name + ' : ' + message);\n\t  });\n\t};\n\t\n\texports.default = capture;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function() {\n\t\treturn __webpack_require__(6)(\"!function(r){function e(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=r,e.c=t,e.p=\\\"/\\\",e(0)}([function(r,e,t){\\\"use strict\\\";var n=t(1),o=void 0,i=void 0,a=void 0,u=void 0,c=void 0,s=function(r){var e=r.data,t=e.buffer,s=e.data1,d=e.data2,f=e.width,v=e.height,l=e.sensitivity,p=e.threshold,g=0;c=1-l,o=new Uint32Array(t);for(var h=0;h<v;++h)for(var x=0;x<f;++x)g=h*f+x,i=(s[4*g]+s[4*g+1]+s[4*g+2])/3/c,a=(d[4*g]+d[4*g+1]+d[4*g+2])/3/c,u=(0,n.polarize)((0,n.abs)(i-a),p),o[g]=255<<24|u<<16|u<<8|u;postMessage(t)};onmessage=s},function(r,e){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});e.createOnceLog=function(){var r=0;return function(){if(r<1){var e;(e=console).log.apply(e,arguments)}r++}},e.$=function(r){return document.querySelector(r)},e.round=function(r){return r+.5>>0},e.abs=function(r){return(r^r>>31)-(r>>31)},e.polarize=function(r,e){return r>e?0:255}}]);\\n//# sourceMappingURL=4c4717f30fba17538544.worker.js.map\", __webpack_require__.p + \"4c4717f30fba17538544.worker.js\");\n\t};\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\r\n\t\r\n\tvar URL = window.URL || window.webkitURL;\r\n\tmodule.exports = function(content, url) {\r\n\t\ttry {\r\n\t\t\ttry {\r\n\t\t\t\tvar blob;\r\n\t\t\t\ttry { // BlobBuilder = Deprecated, but widely implemented\r\n\t\t\t\t\tvar BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\r\n\t\t\t\t\tblob = new BlobBuilder();\r\n\t\t\t\t\tblob.append(content);\r\n\t\t\t\t\tblob = blob.getBlob();\r\n\t\t\t\t} catch(e) { // The proposed API\r\n\t\t\t\t\tblob = new Blob([content]);\r\n\t\t\t\t}\r\n\t\t\t\treturn new Worker(URL.createObjectURL(blob));\r\n\t\t\t} catch(e) {\r\n\t\t\t\treturn new Worker('data:application/javascript,' + encodeURIComponent(content));\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\treturn new Worker(url);\r\n\t\t}\r\n\t}\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/* eslint-disable no-console */\n\t\n\t/*\n\t  utility function to log only once\n\t  useful for logging in loops\n\t*/\n\tvar createOnceLog = exports.createOnceLog = function createOnceLog() {\n\t  var counter = 0;\n\t  return function onceLog() {\n\t    if (counter < 1) {\n\t      var _console;\n\t\n\t      (_console = console).log.apply(_console, arguments);\n\t    }\n\t    counter++;\n\t  };\n\t};\n\t\n\t/*\n\t  utility function to access DOM references\n\t*/\n\tvar $ = exports.$ = function $(selector) {\n\t  return document.querySelector(selector);\n\t};\n\t\n\t/*\n\t  bitwise Math.round\n\t*/\n\tvar round = exports.round = function round(number) {\n\t  return number + .5 >> 0;\n\t};\n\t\n\t/*\n\t  butwise Math.abs\n\t*/\n\tvar abs = exports.abs = function abs(value) {\n\t  return (value ^ value >> 31) - (value >> 31);\n\t};\n\t\n\t/*\n\t  polarize pixel values based on value and threshold\n\t*/\n\tvar polarize = exports.polarize = function polarize(value, threshold) {\n\t  return value > threshold ? 0x00 : 0XFF;\n\t};\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// diffy.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5d38139da365b9cbe5c8","/* eslint-disable no-console */\n\nimport Diffy from './Diffy';\nimport requestAnimFrame from './raf';\nimport capture from './capture';\nimport DiffWorker from 'worker-loader?inline!./worker';\nimport { round } from './utils';\n\nlet instanceExists = false;\n\nexport const create = ({ resolution, sensitivity, threshold, debug, onFrame, sourceDimensions, containerClassName }) => {\n\n  if(!window) {\n    throw new Error(`\n      Diffy.js is meant to be used in the browser. :^)\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n    `);\n  }\n\n  if(!('Worker' in window)) {\n    throw new Error(`\n      Diffy.js requires Web Workers.\n      It looks like this environment does not support this feature. :(\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n    `);\n  }\n\n  if(instanceExists) {\n    throw new Error(`\n      Yikes! It seems like a Diffy.js instance already exists on this page. :|\n      For more info, see: https://github.com/maniart/diffyjs/blob/master/README.md\n    `);\n  }\n\n  const diffy = Diffy.create({\n    tickFn: requestAnimFrame,\n    captureFn: capture,\n    DiffWorker,\n    roundFn: round,\n    win: window,\n    doc: document,\n    resolution,\n    sensitivity,\n    threshold,\n    debug,\n    onFrame,\n    sourceDimensions,\n    containerClassName\n  });\n\n  instanceExists = true;\n  return diffy;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","export default class Diffy {\n  constructor({\n    tickFn = () => {},\n    captureFn = () => {},\n    DiffWorker = () => {},\n    roundFn = () => {},\n    win = {},\n    doc = {},\n    debug = false,\n    sourceDimensions = { w: 130, h: 100 },\n    onFrame = () => {},\n    sensitivity = 0.2,\n    threshold = 21,\n    containerClassName = 'diffy--debug-view',\n    resolution = { x: 10, y: 5 }\n  }) {\n\n    const _win = win;\n    this.doc = doc;\n\n    const baseCaptureConfig = {\n      audio: false,\n      video: {\n        width: 130,\n        height: 100\n      }\n    };\n\n    this.captureConfig = Object.assign({}, baseCaptureConfig, {\n      video: { width: sourceDimensions.w, height: sourceDimensions.h}\n    });\n\n    this.tickFn = tickFn.bind(_win);\n    this.captureFn = captureFn;\n    this.roundFn = roundFn;\n\n    this.onFrame = onFrame;\n\n    this.currentImageData = null;\n    this.previousImageData = null;\n\n    this.resolutionX = resolution.x;\n    this.resolutionY = resolution.y;\n\n    this.sensitivity = sensitivity;\n    this.threshold = threshold;\n\n    this.debug = debug;\n    this.containerClassName = containerClassName;\n    this.debugViewCollapsed = false;\n\n    this.sourceWidth = sourceDimensions.w;\n    this.sourceHeight = sourceDimensions.h;\n\n    this.worker = new DiffWorker;\n\n    this.initialized = false;\n\n    this.VERSION = '1.2.2';\n\n    _win.addEventListener('load', this.init.bind(this));\n  }\n\n  toVideo(blob, videoEl) {\n    // piping blob to video element\n    videoEl.src = blob;\n  }\n\n  toCanvas(video, canvas) {\n    // piping video to canvas\n    canvas\n      .getContext('2d')\n      .drawImage(video, 0, 0, canvas.width, canvas.height);\n  }\n\n  mirror(canvas) {\n    const ctx = canvas.getContext('2d');\n    ctx.translate(canvas.width, 0);\n    ctx.scale(-1, 1);\n    return canvas;\n  }\n\n  compare(frame1, frame2) {\n    const data1 = frame1.data;\n    const data2 = frame2.data;\n    const length = data1.length;\n    const buffer = new ArrayBuffer(length);\n\n    this.worker.postMessage({\n      buffer,\n      data1,\n      data2,\n      sensitivity: this.sensitivity,\n      threshold: this.threshold,\n      width: this.sourceWidth,\n      height: this.sourceHeight\n    });\n  }\n\n  drawBlendImageFromBuffer(buffer) {\n    this.blendImageData\n      .data\n      .set(\n        new Uint8ClampedArray(buffer)\n      );\n\n    this.blendCanvasCtx.putImageData(this.blendImageData, 0, 0);\n    this.previousImageData = this.currentImageData;\n  }\n\n  /*\n    blend two consecutive frames\n    returns imageData\n  */\n  blend(canvas) {\n    const ctx = canvas.getContext('2d');\n    const width = canvas.width;\n    const height = canvas.height;\n    this.currentImageData = ctx.getImageData(0, 0, width, height);\n    this.previousImageData = this.previousImageData || ctx.getImageData(0, 0, width, height);\n    this.compare(this.currentImageData, this.previousImageData);\n  }\n\n  createMatrix() {\n    let i;\n    let j;\n    let k = 0;\n\n    const matrix = [];\n    const sourceWidth = this.sourceWidth;\n    const sourceHeight = this.sourceHeight;\n    const cellWidth = this.sourceWidth / this.resolutionX;\n    const cellHeight = this.sourceHeight / this.resolutionY;\n\n\n    let cellImageData = null;\n    let cellImageDataLength;\n    let cellPixelCount;\n    let average = 0;\n\n    for(i = 0; i < sourceWidth; i += cellWidth) {\n      const row = [];\n\n      for(j = 0; j < sourceHeight; j += cellHeight) {\n        cellImageData = this.blendCanvasCtx.getImageData(i, j, cellWidth, cellHeight).data;\n\n        /* TODO refactor with bitshifting */\n        cellImageDataLength = cellImageData.length;\n        cellPixelCount = cellImageDataLength / 4;\n        while(k < cellPixelCount) {\n          average += (cellImageData[k * 4] + cellImageData[k * 4 + 1] + cellImageData[k * 4 + 2]) / 3;\n          ++ k;\n        }\n        average = this.roundFn(average / cellPixelCount);\n        /* push the value in the row */\n        row.push(average);\n        average = 0;\n        k = 0;\n      }\n      matrix.push(row); // store the row in matrix\n    }\n\n    return matrix;\n  }\n\n  loop() {\n    this.toCanvas(this.videoEl, this.rawCanvasEl);\n    this.blend(this.rawCanvasEl);\n    this.onFrame(this.createMatrix());\n    this.tickFn(this.loop.bind(this));\n  }\n\n  init() {\n    this.worker.addEventListener('error', (e) => {\n      throw e;\n    });\n    this.worker.addEventListener('message', ({ data }) => {\n      this.drawBlendImageFromBuffer(data);\n    });\n    this.initDom(this.containerClassName);\n    this.blendCanvasCtx = this.blendCanvasEl.getContext('2d');\n    this.blendImageData = this.blendCanvasCtx.getImageData(0, 0, this.sourceWidth, this.sourceHeight);\n\n    this.captureFn(this.captureConfig).then((blob) => {\n      [this.rawCanvasEl, this.blendCanvasEl].forEach(this.mirror);\n      this.toVideo(blob, this.videoEl);\n      this.loop();\n    });\n    this.initialized = true;\n  }\n\n  createElements(containerClassName) {\n    this.containerEl = this.doc.createElement('div');\n    this.containerEl.className = containerClassName;\n\n    this.videoEl = this.doc.createElement('video');\n    this.videoEl.className = 'video view';\n    this.videoEl.setAttribute('autoplay', '');\n    this.videoEl.width = this.sourceWidth;\n    this.videoEl.height = this.sourceHeight;\n\n    this.rawCanvasEl = this.doc.createElement('canvas');\n    this.rawCanvasEl.className = 'canvas--raw view';\n    this.rawCanvasEl.width = this.sourceWidth;\n    this.rawCanvasEl.height = this.sourceHeight;\n\n    this.blendCanvasEl = this.doc.createElement('canvas');\n    this.blendCanvasEl.className = 'canvas--blend view';\n    this.blendCanvasEl.width = this.sourceWidth;\n    this.blendCanvasEl.height = this.sourceHeight;\n\n    this.headerEl = this.doc.createElement('header');\n    this.headerEl.className = 'header';\n\n    this.titleEl = this.doc.createElement('h1');\n    this.titleEl.className = 'title';\n    this.titleEl.innerText = 'Diffy debug view';\n\n    this.toggleEl = this.doc.createElement('span');\n    this.toggleEl.className = 'toggle';\n    this.toggleEl.innerText = '-';\n\n    this.headerEl.addEventListener('click', (ev) => {\n      ev.preventDefault();\n      [this.videoEl, this.rawCanvasEl, this.blendCanvasEl].forEach((el) => {\n        if (this.debugViewCollapsed) {\n          el.classList.remove('hidden');\n          this.toggleEl.innerText = '-';\n        } else {\n          el.classList.add('hidden');\n          this.toggleEl.innerText = '+';\n        }\n      });\n      this.debugViewCollapsed = !this.debugViewCollapsed;\n    });\n\n    this.headerEl.appendChild(this.toggleEl);\n    this.headerEl.appendChild(this.titleEl);\n\n    this.containerEl.appendChild(this.headerEl);\n    this.containerEl.appendChild(this.videoEl);\n    this.containerEl.appendChild(this.rawCanvasEl);\n    this.containerEl.appendChild(this.blendCanvasEl);\n\n    this.doc.body.appendChild(this.containerEl);\n\n    if (!this.debug) {\n      this.containerEl.classList.add('hidden');\n    }\n  }\n\n  injectCssStyles() {\n    const node = this.doc.createElement('style');\n    const containerClassName = this.containerClassName;\n    const styles = `\n      .${containerClassName} {\n        position: fixed;\n        top: 0;\n        left: 0;\n        font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n        background-color: #000;\n        border: 4px solid #000;\n        color: #fff;\n      }\n      .${containerClassName} .header {\n        width: 100%;\n        background-color: #000;\n        font-size: 16px;\n        cursor: pointer;\n      }\n      .${containerClassName} .title {\n        display: inline;\n        margin-left: 10px;\n        font-weight: 300;\n        letter-spacing: 2px;\n        font-size: 16px;\n      }\n      .${containerClassName} .toggle { padding: 5px; }\n      .${containerClassName} .view { padding: 5px; }\n      .${containerClassName} .view.hidden, .${containerClassName}.hidden { display: none; }\n    `;\n    node.innerHTML = styles;\n    this.doc.body.appendChild(node);\n  }\n\n  initDom(containerClassName) {\n    this.createElements(containerClassName);\n    this.injectCssStyles();\n  }\n\n  static create(options) {\n    return new this(options);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Diffy.js","/*\n  shim requestAnimationFrame api\n  source: http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n*/\nconst requestAnimFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  function(callback) {\n    window.setTimeout(callback, 1000 / 60);\n  };\n\nexport default requestAnimFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./src/raf.js","/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n/*\n  shim getUserMedia with a Promise api\n  source: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n*/\nconst getUserMedia = (constraints, successCallback, errorCallback) => {\n\n  // First get a hold of getUserMedia, if present\n  const getUserMedia = (navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia);\n\n  // Some browsers just don't implement it - return a rejected promise with an error\n  // to keep a consistent interface\n  if(!getUserMedia) {\n    return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n  }\n\n  // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n  return new Promise((successCallback, errorCallback) => {\n    getUserMedia.call(navigator, constraints, successCallback, errorCallback);\n  });\n\n}\n\n// Older browsers might not implement mediaDevices at all, so we set an empty object first\nif(navigator.mediaDevices === undefined) {\n  navigator.mediaDevices = {};\n}\n\n// Some browsers partially implement mediaDevices. We can't just assign an object\n// with getUserMedia as it would overwrite existing properties.\n// Here, we will just add the getUserMedia property if it's missing.\nif(navigator.mediaDevices.getUserMedia === undefined) {\n  navigator.mediaDevices.getUserMedia = getUserMedia;\n}\n\n/*\n  capture from camera\n  returns objectUrl\n */\nconst capture = (constraints) => {\n  return navigator.mediaDevices.getUserMedia(constraints)\n    .then((stream) => window.URL.createObjectURL(stream))\n    .catch(({ name, message }) => console.error(`${name} : ${message}`));\n}\n\nexport default capture;\n\n\n\n// WEBPACK FOOTER //\n// ./src/capture.js","module.exports = function() {\n\treturn require(\"!!/Users/maninilchiani/Self/diffyjs/node_modules/worker-loader/createInlineWorker.js\")(\"!function(r){function e(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=r,e.c=t,e.p=\\\"/\\\",e(0)}([function(r,e,t){\\\"use strict\\\";var n=t(1),o=void 0,i=void 0,a=void 0,u=void 0,c=void 0,s=function(r){var e=r.data,t=e.buffer,s=e.data1,d=e.data2,f=e.width,v=e.height,l=e.sensitivity,p=e.threshold,g=0;c=1-l,o=new Uint32Array(t);for(var h=0;h<v;++h)for(var x=0;x<f;++x)g=h*f+x,i=(s[4*g]+s[4*g+1]+s[4*g+2])/3/c,a=(d[4*g]+d[4*g+1]+d[4*g+2])/3/c,u=(0,n.polarize)((0,n.abs)(i-a),p),o[g]=255<<24|u<<16|u<<8|u;postMessage(t)};onmessage=s},function(r,e){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});e.createOnceLog=function(){var r=0;return function(){if(r<1){var e;(e=console).log.apply(e,arguments)}r++}},e.$=function(r){return document.querySelector(r)},e.round=function(r){return r+.5>>0},e.abs=function(r){return(r^r>>31)-(r>>31)},e.polarize=function(r,e){return r>e?0:255}}]);\\n//# sourceMappingURL=4c4717f30fba17538544.worker.js.map\", __webpack_public_path__ + \"4c4717f30fba17538544.worker.js\");\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/worker-loader?inline!./src/worker.js\n// module id = 5\n// module chunks = 0","// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\r\n\r\nvar URL = window.URL || window.webkitURL;\r\nmodule.exports = function(content, url) {\r\n\ttry {\r\n\t\ttry {\r\n\t\t\tvar blob;\r\n\t\t\ttry { // BlobBuilder = Deprecated, but widely implemented\r\n\t\t\t\tvar BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\r\n\t\t\t\tblob = new BlobBuilder();\r\n\t\t\t\tblob.append(content);\r\n\t\t\t\tblob = blob.getBlob();\r\n\t\t\t} catch(e) { // The proposed API\r\n\t\t\t\tblob = new Blob([content]);\r\n\t\t\t}\r\n\t\t\treturn new Worker(URL.createObjectURL(blob));\r\n\t\t} catch(e) {\r\n\t\t\treturn new Worker('data:application/javascript,' + encodeURIComponent(content));\r\n\t\t}\r\n\t} catch(e) {\r\n\t\treturn new Worker(url);\r\n\t}\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/worker-loader/createInlineWorker.js\n// module id = 6\n// module chunks = 0","/* eslint-disable no-console */\n\n/*\n  utility function to log only once\n  useful for logging in loops\n*/\nexport const createOnceLog = () => {\n  let counter = 0;\n  return function onceLog() {\n    if(counter < 1) {\n      console.log(...arguments);\n    }\n    counter ++;\n  }\n}\n\n/*\n  utility function to access DOM references\n*/\nexport const $ = (selector) => document.querySelector(selector);\n\n/*\n  bitwise Math.round\n*/\nexport const round = (number) => (number + .5) >> 0;\n\n/*\n  butwise Math.abs\n*/\nexport const abs = (value) => (value ^ (value >> 31)) - (value >> 31);\n\n\n/*\n  polarize pixel values based on value and threshold\n*/\nexport const polarize = (value, threshold) => (value > threshold) ? 0x00 : 0XFF;\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js"],"sourceRoot":""}